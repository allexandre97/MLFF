{
    "paths":{
        "out_dir":"/cephfs/alexandrebg/runs/reg_cond_no_sims_anneal_slow"
    },

    "training":{

	"verbose":false,
	
	"use_gaff_simulations":true,
	
	"n_frames_val_cond":500,
	
	"train_size":0.9,
	
	"n_epochs":200,
	
	"condensed_indiv_first_epoch":1,
	"condensed_indiv_sims_epoch":1000,
	"condensed_joint_first_epoch":1,
	"condensed_joint_sims_epoch":1000,
	
	"vdw_reg_epoch":1,
	
	"vdw_fn_epoch_switch":20,
	
	"n_minibatch":256,
	
	"loss_weight_force":1e-3,
	"loss_weight_force_inter":10.0,
	"loss_weight_energy":1e-2,
	"loss_weight_charge":5.0,
	"loss_weight_vdw_entropy_0":10.0,
	"loss_weight_vdw_entropy_min":0.01,
	"loss_weight_torsion_ks":1e-2,
	"loss_weight_enth_vap":0.0188,
	"loss_weight_enth_mixing":0.1,
	"loss_weight_regularisation":1e-5,
	"loss_weight_vdw_params":1e-3,
	"loss_energy_first_epoch":1,
	
	"anneal_first_epoch":100,
	"tau_min":0.25,
	"tau_0":0.5,
	"tau_min_epoch":100,
	"tau_mult_first":100.0,
	"beta_min":0.1,
	"gamma":1.0,
	"entropy_min_epoch":100000,
	
	"train_on_forces_intra":1.0,
	"train_on_forces_inter":1.0,
	"train_on_pe":1.0,
	"train_on_charges":0.0,
	"train_on_entropy":1.0,
	"train_on_enth_vap":1.0,
	"train_on_enth_mix":1.0,
	
	"enth_vap_gas_n_samples":10,
	
	"grad_clamp_val":1e3
    },

    "networks":{

        "learning_rate":1e-4,

        "n_atom_features_in": 29,

        "dim_embed_atom":64,
        "dim_embed_inter":64,
        "dim_hidden_dense": 128,
        "dim_hidden_gnn": 128,
        "dim_hidden_pairwise": 64,

        "gcn_conv_layer":"SAGEConv",
        "activation_str": "relu",
        "aggr_str":"mean",

        "dropout_dense":0.0,
        "n_layers_nn":2
    },

    "physics":{

        "vdw_functional_form":"lj",
        "mixing_function":"lb",
        "dist_nb_cutoff":1.0,
        "bond_functional_form":"harmonic",
        "bond_r1":0.05,
        "bond_r2":0.30,
        "angle_functional_form":"harmonic",
        "angle_r1":0.0,
        "angle_r2":180.0,
        "n_proper_terms":6,
        "n_improper_terms":2,

        "use_reaction_field":true
    }
}
